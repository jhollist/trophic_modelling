{
    "collab_server" : "",
    "contents" : "#' Create map of Ecoregions\n#' \n#' Function to generate Map 1 in hkm2014ESA poster\n#' \n#' @param states data for states, as data.frame\n#' @param lakes point locations for lake samples as data.frame\n#' @param myColor vector of length 3 with colors for fill, lines, and points in that order\n#' \n#' @examples\n#' devtools::install_github(\"jhollist/autocrop\")\n#' devtools::install_github(\"USEPA/LakeTrophiModelling\")\n#' library(ggplot2)\n#' library(rgdal)\n#' library(plyr)\n#' library(maptools)\n#' library(viridis)\n#' library(autocrop)\n#'\n#' wsa9 <- readOGR(system.file(\"extdata\",package=\"LakeTrophicModelling\"),\"wsa9_low48\")\n#' nla <- read.csv(system.file(\"extdata/ltmData.csv\",package=\"LakeTrophicModelling\"))\n#' lakes_alb<-data.frame(nla[[\"AlbersX\"]],nla[[\"AlbersY\"]]) \n#' p4s<-\"+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=37.5 +lon_0=-96 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs\" \n#' lakes_alb_sp<-SpatialPoints(coordinates(lakes_alb),proj4string=CRS(p4s))\n#' \n#' ggsave(plot=ecor_nla_map(wsa9,lakes_alb_sp),filename=\"ecor_nla_map.tiff\",width=8.5)\n#' autocrop(\"ecor_nla_map.tiff\",10,\"ecor_nla_map.tiff\")\n#' \n#' @export\n#' @import ggplot2\necor_nla_map<-function(ecor,nla_pts){\n  #borrowed from: https://github.com/hadley/ggplot2/wiki/plotting-polygon-shapefiles#workaround-forced-layering-of-geom_plot\n  ecor@data$id <- rownames(ecor@data)\n  ecor_f <- fortify(ecor, region=\"WSA_9\")\n  names(ecor_f)[which(names(ecor_f)==\"id\")] = \"WSA_9\"\n  ecor_df <- plyr::join(ecor_f, ecor@data, by=\"WSA_9\")\n  nla_dd<-spTransform(nla_pts,\n                        CRS=CRS(\"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs\"))\n  nla_dd<-data.frame(coordinates(nla_dd))\n  names(nla_dd)<-c(\"long\",\"lat\")\n  gmap<-ggplot(ecor_df, aes(long,lat,group=group,fill=WSA_9)) +\n    geom_polygon(data=subset(ecor_df,WSA_9!=\"Western Mountains (WMT)\")) +\n    geom_polygon(data=subset(ecor_df,WSA_9==\"Western Mountains (WMT)\")) +\n    geom_path(color=\"white\") +\n    geom_point(data = nla_dd, aes(x=long,y=lat,group=\"\",fill=\"\"),size=1.5) +\n    coord_equal() +\n    coord_map(\"albers\", lat2 = 45.5, lat1 = 29.5)+\n    theme(panel.background = element_rect(fill=\"white\"), panel.grid = element_blank(),\n          panel.border = element_blank(), #legend.position = \"none\",\n          axis.text = element_blank(),axis.ticks = element_blank(),\n          legend.text = element_text(size=10),\n          legend.key.width = unit(0.5, \"line\")) +\n    ylab(\"\") +\n    xlab(\"\") +\n    scale_fill_manual(name=\"\",values=viridis(10))\n    \n  return(gmap)\n}",
    "created" : 1464803402109.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1848282728",
    "id" : "B73DB32",
    "lastKnownWriteTime" : 1464807039,
    "path" : "/data/projects/trophic_modelling/R/ecor_nla_map.R",
    "project_path" : "R/ecor_nla_map.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : true,
    "source_window" : "",
    "type" : "r_source"
}